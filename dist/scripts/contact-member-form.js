(function(){const C="https://epszwomtxkpjegbjbixr.supabase.co";function g(){var o,n,a,S,s,c,q,l,d,i,u,b,f;let t=document.querySelector(".contact-member-form")||document.getElementById("contact-member-form")||document.querySelector('[data-form="contact-member"]')||document.querySelector(".member-contact-form form")||document.querySelector('[class*="member-contact-form"] form')||document.querySelector('[class*="contact-member"] form');if(!t){const m=document.querySelector('[data-form="contact-member"]');m&&(t=m.querySelector("form")||m)}if(!t){console.log("Contact member form not found on this page");return}console.log("Contact member form found, attaching handler");const e=((o=t.querySelector('[name="memberstack-id"]'))==null?void 0:o.value)||((n=t.querySelector('[name="memberstack"]'))==null?void 0:n.value)||t.dataset.memberstackId||((a=document.querySelector('[name="memberstack-id"]'))==null?void 0:a.value)||((S=document.querySelector('[name="memberstack"]'))==null?void 0:S.value)||((s=document.querySelector("[data-memberstack-id]"))==null?void 0:s.dataset.memberstackId)||((c=document.querySelector("#memberstack"))==null?void 0:c.value),r=((q=t.querySelector('[name="member-name"]'))==null?void 0:q.value)||((l=t.querySelector('[name="first-name"]'))==null?void 0:l.value)||t.dataset.memberName||((d=document.querySelector('[name="member-name"]'))==null?void 0:d.value)||((i=document.querySelector('[name="first-name"]'))==null?void 0:i.value)||((u=document.querySelector("[data-member-name]"))==null?void 0:u.dataset.memberName)||((f=(b=document.querySelector(".member-name"))==null?void 0:b.textContent)==null?void 0:f.trim());if(!e){console.error("Memberstack ID not found for contact form"),console.log('Searched for: [name="memberstack-id"], [name="memberstack"], #memberstack, [data-memberstack-id]');return}t.dataset.memberstackId=e,t.dataset.memberName=r||"Member",t.addEventListener("submit",w)}async function w(t){var l,d,i,u,b,f,m,p,v,h;t.preventDefault(),t.stopPropagation();const e=t.target,r=e.querySelector('[type="submit"]')||e.querySelector('input[type="submit"]'),o=(r==null?void 0:r.value)||(r==null?void 0:r.textContent),n=(d=(l=e.querySelector('[name="name"], [name="Name"], [name="sender-name"]'))==null?void 0:l.value)==null?void 0:d.trim(),a=(u=(i=e.querySelector('[name="email"], [name="Email"]'))==null?void 0:i.value)==null?void 0:u.trim(),S=(f=(b=e.querySelector('[name="phone"], [name="Phone"], [name="contact-number"], [name="Contact-Number"], [name="Contact-1-Name-2"]'))==null?void 0:b.value)==null?void 0:f.trim(),s=(p=(m=e.querySelector('[name="subject"], [name="Subject"], [name="Enquiry-Subject"], [name="enquiry-subject"]'))==null?void 0:m.value)==null?void 0:p.trim(),c=(h=(v=e.querySelector('[name="message"], [name="Message"], [name="Enquiry-Details"], [name="enquiry-details"]'))==null?void 0:v.value)==null?void 0:h.trim();if(!n||!a||!s||!c){y(e,"Please fill in all required fields.","error");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)){y(e,"Please enter a valid email address.","error");return}r&&(r.disabled=!0,r.tagName==="INPUT"?r.value="Sending...":r.textContent="Sending...");try{const x=await(await fetch(C+"/functions/v1/contact-member",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderName:n,senderEmail:a,senderPhone:S||null,subject:s,message:c,memberstackId:e.dataset.memberstackId,memberName:e.dataset.memberName})})).json();if(x.success){y(e,"Your message has been sent! The member will receive a notification and can reply through their dashboard.","success"),e.reset();const P=e.querySelector(".form-fields")||e,N=e.querySelector(".w-form-done");N&&(P.style.display="none",N.style.display="block")}else throw new Error(x.error||"Failed to send message")}catch(k){console.error("Contact form error:",k),y(e,"Sorry, there was an error sending your message. Please try again.","error")}finally{r&&(r.disabled=!1,r.tagName==="INPUT"?r.value=o:r.textContent=o)}}function y(t,e,r){const o=t.querySelector(".w-form-done"),n=t.querySelector(".w-form-fail");if(r==="success"&&o)o.style.display="block",o.textContent=e,n&&(n.style.display="none");else if(r==="error"&&n)n.style.display="block",n.textContent=e,o&&(o.style.display="none");else{let a=t.querySelector(".form-message");a||(a=document.createElement("div"),a.className="form-message",t.insertBefore(a,t.firstChild)),a.textContent=e,a.style.cssText=r==="success"?"padding: 12px; background: #d4edda; color: #155724; border-radius: 4px; margin-bottom: 16px;":"padding: 12px; background: #f8d7da; color: #721c24; border-radius: 4px; margin-bottom: 16px;"}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",g):g()})();
